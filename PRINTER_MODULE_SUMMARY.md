# –ú–æ–¥—É–ª—å 5: –°–∏—Å—Ç–µ–º–∞ –ø–µ—á–∞—Ç–∏ —á–µ–∫–æ–≤ ESC/POS - –ó–ê–í–ï–†–®–ï–ù–û ‚úÖ

## –î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è: 29.10.2023

## –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### 1. –û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å
- `felix_hub/backend/utils/printer.py` - –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –ø–µ—á–∞—Ç–∏
  - –§—É–Ω–∫—Ü–∏–∏: print_order_receipt, wrap_text, print_test_receipt, generate_order_pdf, print_order_with_fallback
  - 300+ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞
  - –ü–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
  - Graceful error handling

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- `felix_hub/backend/app.py` - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Flask API
  - –ò–º–ø–æ—Ä—Ç –º–æ–¥—É–ª—è –ø–µ—á–∞—Ç–∏
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—á–∞—Ç—å –ø—Ä–∏ —Å—Ç–∞—Ç—É—Å–µ "–≥–æ—Ç–æ–≤"
  - POST /api/orders/<id>/print - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—á–∞—Ç—å
  - POST /api/printer/test - —Ç–µ—Å—Ç–æ–≤–∞—è –ø–µ—á–∞—Ç—å

- `felix_hub/backend/.env.example` - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–Ω—Ç–µ—Ä–∞
  - PRINTER_ENABLED
  - PRINTER_IP
  - PRINTER_PORT
  - RECEIPT_WIDTH

### 3. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `felix_hub/backend/docs/PRINTER_SETUP.md` - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ (6.5KB)
- `felix_hub/backend/PRINTER_README.md` - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–æ–¥—É–ª—è (11KB)
- `felix_hub/backend/PRINTER_IMPLEMENTATION.md` - –û—Ç—á–µ—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (9KB)
- `felix_hub/backend/EXAMPLE_USAGE.md` - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (11KB)

### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- `felix_hub/backend/test_printer.py` - Unit —Ç–µ—Å—Ç—ã (15 —Ç–µ—Å—Ç–æ–≤)
- `felix_hub/backend/test_printer_integration.py` - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

### ‚úÖ –ü–µ—á–∞—Ç—å –Ω–∞ —Ç–µ—Ä–º–æ–ø—Ä–∏–Ω—Ç–µ—Ä–µ ESC/POS
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤ 58–º–º –∏ 80–º–º
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ–∫–∞: –∑–∞–≥–æ–ª–æ–≤–æ–∫, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –¥–µ—Ç–∞–ª–∏, —Ñ—É—Ç–µ—Ä
- QR-–∫–æ–¥ —Å ID –∑–∞–∫–∞–∑–∞
- –ü–µ—Ä–µ–Ω–æ—Å –¥–ª–∏–Ω–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π –¥–µ—Ç–∞–ª–µ–π
- –≠–º–æ–¥–∑–∏ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è

### ‚úÖ Fallback –Ω–∞ PDF
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ PDF –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø—Ä–∏–Ω—Ç–µ—Ä–∞
- –§–æ—Ä–º–∞—Ç A4 –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ /tmp/ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∏–º–µ–Ω–µ–º

### ‚úÖ API Endpoints
1. POST /api/orders/<id>/print - –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—á–∞—Ç—å
2. POST /api/printer/test - –¢–µ—Å—Ç–æ–≤–∞—è –ø–µ—á–∞—Ç—å
3. PATCH /api/orders/<id> - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—á–∞—Ç—å –ø—Ä–∏ status="–≥–æ—Ç–æ–≤"

### ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- –ß–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è .env
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –ø–µ—á–∞—Ç–∏
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ IP, –ø–æ—Ä—Ç–∞, —à–∏—Ä–∏–Ω—ã —á–µ–∫–∞

### ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- Graceful handling –≤—Å–µ—Ö –æ—à–∏–±–æ–∫
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- –ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ
- –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API
- Troubleshooting guide
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤:
```
‚úì –¢–µ—Å—Ç –ø–µ—Ä–µ–Ω–æ—Å–∞ —Ç–µ–∫—Å—Ç–∞ –ø—Ä–æ–π–¥–µ–Ω
‚úì –¢–µ—Å—Ç —Å –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã–º –ø—Ä–∏–Ω—Ç–µ—Ä–æ–º –ø—Ä–æ–π–¥–µ–Ω
‚úì –§–æ—Ä–º–∞—Ç —á–µ–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω
‚úì –í–°–ï –ò–ù–¢–ï–ì–†–ê–¶–ò–û–ù–ù–´–ï –¢–ï–°–¢–´ –ü–†–û–ô–î–ï–ù–´
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞:
```
‚úì printer.py syntax is valid
‚úì app.py syntax is valid
‚úì All printer functions imported successfully
```

## –§–æ—Ä–º–∞—Ç —á–µ–∫–∞

```
================================
        –°–¢–û Felix
   –ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å –ø—Ä–µ–º–∏—É–º –∫–ª–∞—Å—Å–∞
================================
–ó–∞–∫–∞–∑ ‚Ññ12345
–î–∞—Ç–∞: 29.10.2023 14:30
–ú–µ—Ö–∞–Ω–∏–∫: –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤
VIN: WVWZZZ1KZBW123456
–ö–∞—Ç–µ–≥–æ—Ä–∏—è: –î–≤–∏–≥–∞—Ç–µ–ª—å
================================
–ó–∞–ø—á–∞—Å—Ç–∏:
1. –§–∏–ª—å—Ç—Ä –º–∞—Å–ª—è–Ω—ã–π –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π
2. –°–≤–µ—á–∏ –∑–∞–∂–∏–≥–∞–Ω–∏—è NGK
3. –ü—Ä–æ–∫–ª–∞–¥–∫–∞ –∫–ª–∞–ø–∞–Ω–Ω–æ–π –∫—Ä—ã—à–∫–∏
================================
–¢–∏–ø: ‚ú® –û—Ä–∏–≥–∏–Ω–∞–ª
–°—Ç–∞—Ç—É—Å: –ì–û–¢–û–í
üì∏ –§–æ—Ç–æ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–æ
================================

     –°–ø–∞—Å–∏–±–æ –∑–∞ —Ä–∞–±–æ—Ç—É!
     Felix Auto Service
  –ù–∞–ø–µ—á–∞—Ç–∞–Ω–æ: 29.10.2023 14:30

    [QR: FELIX-ORDER-12345]
================================
```

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏ (–≤—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã ‚úÖ)

- ‚úÖ –ú–æ–¥—É–ª—å printer.py —Å–æ–∑–¥–∞–Ω —Å–æ –≤—Å–µ–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏
- ‚úÖ print_order_receipt() –ø–µ—á–∞—Ç–∞–µ—Ç —á–µ–∫ –Ω–∞ —Ç–µ—Ä–º–æ–ø—Ä–∏–Ω—Ç–µ—Ä–µ
- ‚úÖ –§–æ—Ä–º–∞—Ç —á–µ–∫–∞: –∑–∞–≥–æ–ª–æ–≤–æ–∫, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –¥–µ—Ç–∞–ª–∏, —Ñ—É—Ç–µ—Ä
- ‚úÖ QR-–∫–æ–¥ —Å ID –∑–∞–∫–∞–∑–∞ –ø–µ—á–∞—Ç–∞–µ—Ç—Å—è (–µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)
- ‚úÖ –î–ª–∏–Ω–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π –ø–µ—Ä–µ–Ω–æ—Å—è—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ generate_order_pdf() —Å–æ–∑–¥–∞–µ—Ç PDF-—á–µ–∫
- ‚úÖ print_order_with_fallback() –ø—Ä–æ–±—É–µ—Ç –æ–±–∞ –º–µ—Ç–æ–¥–∞
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å app.py: –ø–µ—á–∞—Ç—å –ø—Ä–∏ —Å—Ç–∞—Ç—É—Å–µ "–≥–æ—Ç–æ–≤"
- ‚úÖ POST /api/orders/<id>/print –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π –ø–µ—á–∞—Ç–∏
- ‚úÖ POST /api/printer/test –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π –ø–µ—á–∞—Ç–∏
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ .env (IP, PORT, WIDTH)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (–ø—Ä–∏–Ω—Ç–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –ø—Ä–∏–Ω—Ç–µ—Ä–∞
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –µ—Å–ª–∏ –ø—Ä–∏–Ω—Ç–µ—Ä –≤—ã–∫–ª—é—á–µ–Ω (fallback –Ω–∞ PDF)

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (—É–∂–µ –≤ requirements.txt)

- python-escpos==3.0
- reportlab==4.0.7

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å .env —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ø—Ä–∏–Ω—Ç–µ—Ä–∞
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: pip install -r requirements.txt
3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: python app.py
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å: curl -X POST http://localhost:5000/api/printer/test

## –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

**‚úÖ –ì–û–¢–û–í–û –ö PRODUCTION –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ**

–ú–æ–¥—É–ª—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω.
–°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º –ø—Ä–∏–Ω—Ç–µ—Ä–æ–º –∏ –±–µ–∑ –Ω–µ–≥–æ (fallback –Ω–∞ PDF).

---

–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫: Felix Auto Service - Development Team
–í–µ—Ä—Å–∏—è: 1.0.0
